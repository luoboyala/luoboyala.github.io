---
title: Oracleå®è·µæ•°æ®åº“ç¬”è®°-9
description: äº†è§£æ•°æ®åº“Oracleçš„å­˜å‚¨å±‚æ¬¡ç»“æ„ï¼Œç®¡ç†Oracleçš„è¡¨ç©ºé—´å’Œæ•°æ®æ–‡ä»¶çš„ç›¸å…³æŒ‡ä»¤ï¼Œä»¥åŠå®è·µ
categories:
  - è¯¾ç¨‹
tags:
  - Oracle
---
# 03/30 å®è·µæ•°æ®åº“(PPT D36245)

## ç®¡ç†è¡¨ç©ºé—´å’Œæ•°æ®æ–‡ä»¶

1. æ•°æ®åº“çš„å­˜å‚¨å±‚æ¬¡ç»“æ„ PPT153
    + æ•°æ®åº“,
    + è¡¨ç©ºé—´,
    + æ®µ(å­˜å‚¨ç»“æ„)
    + åŒº(æœ€å°çš„ç©ºé—´åˆ†é…å•ä½)___ç©ºé—´ç®¡ç†
        + æ•°æ®å­—å…¸ç®¡ç†[å ç”¨ç³»ç»Ÿè¡¨ç©ºé—´,å¢åŠ ç³»ç»Ÿè´Ÿæ‹…,ç°å·²è¢«åºŸå¼ƒ]
        + æœ¬åœ°ç®¡ç† bitmapä½å›¾
            extend_id bitmap
            1           1
            2           0 //å¯ç”¨
    + å—(æœ€å°çš„IOå•ä½) æ ¹æ®è®¿é—®æ•°æ®é‡æ¥æ§åˆ¶å—çš„å•ä½å¤§å°
    + ç¢ç‰‡,æœ¬åœ°ç®¡ç†
    ä¾æ®ç®¡ç†å’Œæ€§èƒ½åˆ†é…è¡¨ç©ºé—´
    ç´¢å¼•å’Œæ•°æ®ä¸è¦æ”¾åœ¨ä¸€ä¸ªè¡¨ç©ºé—´é‡Œ
2. ç©ºé—´ç®¡ç†
    + ç³»ç»Ÿç©ºé—´
    + éç³»ç»Ÿç©ºé—´
3. åˆ›å»ºè¡¨ç©ºé—´
    ```sql
        desc dba_segments
        show parameter db_block_size
        create tablespace tbs1 datafile 'D:\app\hwj\oradata\sales\tbs1.dbf' size 10m blocksize 2048;---æŠ¥é”™
        alter session set nls_language=america;---è§£å†³æŠ¥é”™ä¸º?????çš„åŠæ³•
        show parameter cache;
        alter system set db_2k_cache_size= 10m;
        create tablespace userdata datafile 'E:\app\Res0liya\oradata\orcl\userdata01.dbf' size 100m autoextend on next 5m maxsize 200m;---åˆ›å»ºè¡¨ç©ºé—´
        create tablespace userdata datafile 'E:\app\Res0liya\oradata\orcl\userdata01.dbf' size 100m extend management dictionary;---åˆ›å»ºè¡¨ç©ºé—´
        desc dba_tablespaces;---å¦‚æœä½ çš„systemè¡¨ç©ºé—´æ˜¯æœ¬åœ°ç®¡ç†localçš„,é‚£ä½ åªèƒ½åˆ›å»ºæœ¬åœ°ç®¡ç†è¡¨ç©ºé—´,å¦‚æœæ˜¯dictionaryçš„é‚£ä¹ˆä¸¤è€…éƒ½å¯ä»¥åˆ›å»º
    ```
4. è¡¨ç©ºé—´çš„ç±»å‹
    + å¸¸è§„è¡¨ç©ºé—´
    ```sql
        select name from v$tablespace;
    ```
    + ä¸´æ—¶è¡¨ç©ºé—´(æ’åº)
        æ•°æ®åº“å±æ€§è§†å›¾
    ```sql
        desc database_properties;
        select property_name,property_value from database_properties;---default_temp_tablespaceä¸´æ—¶è¡¨ç©ºé—´,default_permament_tablespaceé»˜è®¤å¸¸è§„è¡¨ç©ºé—´
        create tablespace users datafile 'E:\app\Res0liya\oradata\orcl\users01.dbf' size 30m;
        alter database default tablespace users;---è®¾ç½®ä¸ºé»˜è®¤è¡¨ç©ºé—´
        create temporary tablespace temp2 tempfile 'E:\app\Res0liya\oradata\orcl\users02.dbf' size 30m;
        alter database default temporary tablespace temp2;
    ```
    + å¤§æ–‡ä»¶è¡¨ç©ºé—´ç†è§£ä¸€ä¸‹
    ```sql
        default_tbs_type ---smallfile
    ```
    + æ’¤é”€è¡¨ç©ºé—´(æ”¾å›æ»šçš„æ•°æ®çš„DMLä¿®æ”¹ä¹‹å‰å¯ä»¥å›æ»š)
    ```sql
        show parameter undo_tablespace;
        create undo tablespace undotbs2 datafile 'E:\app\Res0liya\oradata\orcl\undotbs02.dbf' size 20m;
        alter system set undo_tablespace=undotbs2;
    ```
5. è¡¨ç©ºé—´çš„çŠ¶æ€
    + æ­£å¸¸çŠ¶æ€(è”æœº,å¯è¯»å¯å†™)
    ```sql
        desc dba_tablespaces;
        select tablespace_name,status from dba_tablespaces;---online,read only
        create table scott.demo(id int,name varchar(20)) tablespace tbs1;
        insert into scott.demo values(1,'luobo');
        insert into scott.demo values(2,'aaa');
        commit;
        alter system checkpoint;
    ```
    + åªè¯»çŠ¶æ€
    ```sql
        alter tablespace tbs1 read only;
        drop table scott.demo;---æ˜¯å¯ä»¥åˆ é™¤æ‰çš„
        alter tablespace tbs1 read write;
        flashback table demo to before drop;
    ```
    + è„±æœºçŠ¶æ€
        ä¸èƒ½è„±æœºçš„è¡¨ç©ºé—´ **system,undotbs1,æ‰€æœ‰çš„ä¸´æ—¶è¡¨ç©ºé—´**
        sysauxè¾…åŠ©ç³»ç»Ÿè¡¨ç©ºé—´,è‡ªåŠ¨ä¼˜åŒ–è°ƒæ•´,è‡ªåŠ¨åŒ–ç®¡ç†,èƒ½å¤Ÿè„±æœº,åŠŸèƒ½å¤±æ•ˆ
        undotbsæ’¤é”€è¡¨ç©ºé—´,æ´»åŠ¨/å½“å‰çš„undotbsä¸èƒ½å¤Ÿè„±æœº
    ```sql
        alter tablespace system offline;---online
    ```
6. åˆ é™¤è¡¨ç©ºé—´
    ```sql
        drop tablespace tbs1;---å†…å®¹ä¸æ˜¯ç©ºçš„,å°±ä¸èƒ½åˆ 
        drop tablespace tbs1 including contents;
    ```
7. OMFçš„è¡¨ç©ºé—´
    ```sql
        show parameter db_create;
        alter system set db_create_file_dest;
        create tablespace tbs2;---æŠ¥é”™
        create tablespace tbs2 datafile 'path' size 10m;
        drop tablespace tbs2;---æ–‡ä»¶æ²¡è¢«åˆ æ‰
        alter system set db_create_file_dest='E:\app\OMF\dest';
        create tablespace tbs2;
        select tablespace name,file_name from æŸä¸ªè¡¨;
        drop tablespace tbs2;---æ–‡ä»¶è¢«åˆ æ‰
    ```
8. æ‰©å±•è¡¨ç©ºé—´ PPT167
    + ä¿®æ”¹åŸæ•°æ®æ–‡ä»¶çš„å¤§å°
        + è‡ªåŠ¨æ‰©å±•
        + æ‰‹åŠ¨æ‰©å±•
    ```sql
        ALTER DATABASE DATAFILE
        '/u01/oradata/userdata02.dbf' SIZE 200M
        AUTOEXTEND ON NEXT 10M MAXSIZE 500M;
        ALTER DATABASE
        DATAFILE '/u03/oradata/userdata02.dbf'
        RESIZE 200M;
    ```
    + æ·»åŠ æ–°çš„æ•°æ®æ–‡ä»¶
    ```sql
        ALTER TABLESPACE app_data
        ADD DATAFILE '/u01/oradata/userdata03.dbf'
        SIZE 200M;
    ```
9. ç§»åŠ¨æ•°æ®æ–‡ä»¶ PPT171
    + å¯ä»¥ç§»åŠ¨ ä¸å†ç”¨çš„æ–‡ä»¶
    + ç‰©ç†ç§»åŠ¨
    + æ›´æ–°æ§åˆ¶æ–‡ä»¶

## å®éªŒ

åˆ›å»ºUSERSè¡¨ç©ºé—´,å¹¶è®¾ç½®ä¸ºæ•°æ®åº“é»˜è®¤çš„æ°¸ä¹…è¡¨ç©ºé—´

1. åˆ›å»ºä¸€ä¸ªç”±4Kçš„å—ç»„æˆè¡¨ç©ºé—´TEST(TEST01.dbf 10M) ğŸ†—
2. å‘TESTè¡¨ç©ºé—´å¢åŠ ä¸€ä¸ª10Mçš„æ•°æ®æ–‡ä»¶(TEST02.dbf),å°†TEST01.DBFä¿®æ”¹ä¸º15m ğŸ†—
3. ç§»åŠ¨TEST01.DBF ğŸ†—
4. åœ¨TESTè¡¨ç©ºé—´å†…åˆ›å»ºä¸€å¼ è¡¨table1(insert)ğŸ†—
5. å°†TESTè¡¨ç©ºé—´æ”¹ä¸ºread onlyğŸ†—
6. åˆ é™¤è¡¨table1ğŸ†—
7. å°†è¡¨ç©ºé—´æ”¹ä¸ºread writeğŸ†—
8. åˆ é™¤TESTè¡¨ç©ºé—´ æ£€æµ‹æ•°æ®æ–‡ä»¶æ˜¯å¦è¢«åˆ é™¤ğŸ†—
9. OMFåˆ›å»ºè¡¨ç©ºé—´ æ£€æµ‹æ•°æ®æ–‡ä»¶æ˜¯å¦è¢«åˆ é™¤ğŸ†—
10. åˆ›å»º1ä¸ªæ’¤é”€è¡¨ç©ºé—´undotbs2,å¹¶æŠŠå®ƒè®¾ä¸ºç³»ç»Ÿå½“å‰çš„æ’¤é”€è¡¨ç©ºé—´ğŸ†—
11. åˆ›å»ºä¸´æ—¶è¡¨ç©ºé—´temp2,å¹¶æŠŠå®ƒè®¾ä¸ºæ•°æ®åº“é»˜è®¤çš„ä¸´æ—¶è¡¨ç©ºé—´ğŸ†—
12. æ²¡æœ‰å¤‡ä»½çš„æ¢å¤(å½’æ¡£æ¨¡å¼)
    + åˆ›å»ºä¸€ä¸ªè¡¨ç©ºé—´TBS1(TBS1.DBF)ğŸ†—
    + åœ¨TBS1è¡¨ç©ºé—´å†…åˆ›å»ºä¸€å¼ è¡¨T1ğŸ†—
    + shutdown immediateğŸ†—
    + æ‰‹å·¥åˆ é™¤è¡¨ç©ºé—´TBS1çš„æ•°æ®æ–‡ä»¶ğŸ†—
    + startupğŸ†—
    + å°†æ•°æ®æ–‡ä»¶TBS1.DBFè„±æœºğŸ†—
    + alter database open;ğŸ†—
    + alter database create datafile 'pth\tbs1.bdf';ğŸ†—
    + recover datafile 'path\tbs1.dbf';ğŸ†—
    + å°†æ•°æ®æ–‡ä»¶TBS1.DBFè”æœºğŸ†—
    + æ£€æŸ¥æ•°æ®æ˜¯å¦æ¢å¤ğŸ†—


```sql
    create tablespace TEST datafile 'E:\app\Res0liya\oradata\orcl\test01.dbf' size 10m blocksize 4096;---æŠ¥é”™
    alter system set db_4k_cache_size=10m;
    create tablespace TEST datafile 'E:\app\Res0liya\oradata\orcl\test01.dbf' size 10m blocksize 4096;
    alter tablespace TEST add datafile 'E:\app\Res0liya\oradata\orcl\test02.dbf' size 10m;
    alter database datafile 'E:\app\Res0liya\oradata\orcl\test01.dbf' resize 15m;
    select tablespace_name,status from dba_tablespaces;
    alter tablespace test offline;
    alter tablespace TEST
  2  rename
  3  datafile 'E:\app\Res0liya\oradata\orcl\test01.dbf'
  4  to 'E:\app\Res0liya\oradata\test01.dbf';
    alter tablespace TEST online;
    create table scott.table1(id int,name varchar(20)) tablespace test;
    insert into scott.table1 values(1,'luobo');
    insert into scott.table1 values(2,'aaa');
    alter tablespace TEST read only;
    select tablespace_name,status from dba_tablespaces;
    drop table scott.table1;
    alter tablespace TEST read write;
    drop tablespace TEST;---æ•°æ®æ–‡ä»¶æœªè¢«åˆ é™¤
    show parameter db_create;
    alter system set db_create_file_dest='E:\app\OMF';
    create tablespace TEST;
    drop tablespace TEST;---æ•°æ®æ–‡ä»¶åˆ é™¤äº†
    create undo tablespace undotbs2 datafile 'E:\app\Res0liya\oradata\orcl\undotbs2.dbf' size 30m;
    alter system set undo_tablespace=undotbs2;
    show parameter undo_tablespace;---æŸ¥è¯¢
    create temporary tablespace temp2 tempfile 'E:\app\Res0liya\oradata\orcl\temp2.dbf' size 30m;
    alter database default temporary tablespace temp2;
    select property_name,property_value from database_properties;---æŸ¥è¯¢
    col PROPERTY_NAME for a32;
    col PROPERTY_VALUE for a32;
    select property_name,property_value from database_properties;
    create tablespace TBS1 datafile 'E:\app\Res0liya\oradata\orcl\tbs01.dbf' size 30m;
    select tablespace_name,status from dba_tablespaces;---æŸ¥è¯¢
```
```sql
    create tablespace TBS1 datafile 'E:\app\Res0liya\oradata\orcl\tbs01.dbf' size 30m;
    select tablespace_name,status from dba_tablespaces;
    create table scott.t1(id int);
    insert table scott.t1 values (1);
    commit;
    alter system checkpoint;
    shutdown immediate
    åˆ é™¤æœ¬åœ°æ–‡ä»¶tbs01.dbf
    startup---æŠ¥é”™
    ORA-01157: æ— æ³•æ ‡è¯†/é”å®šæ•°æ®æ–‡ä»¶ 8 - è¯·å‚é˜… DBWR è·Ÿè¸ªæ–‡ä»¶
    ORA-01110: æ•°æ®æ–‡ä»¶ 8: 'E:\APP\RES0LIYA\ORADATA\ORCL\TBS01.DBF'
    alter database datafile 8 offline;---æŠ¥é”™
    archive log list;---æ£€æŸ¥æ˜¯ä¸æ˜¯å½’æ¡£æ¨¡å¼
    alter database archivelog;--è®¾ç½®äº†å½’æ¡£æ¨¡å¼(è§ä¹‹å‰çš„ç¬”è®°)ä¹‹åå°±ä¸ä¼šæŠ¥é”™
    alter database open;
    alter database create datafile 'E:\APP\RES0LIYA\ORADATA\ORCL\TBS01.DBF';
    recover datafile 'E:\APP\RES0LIYA\ORADATA\ORCL\TBS01.DBF';
    alter database datafile 8 online;
    æœ¬åœ°æ–‡ä»¶tbs01.dbfå›æ¥äº†
    desc scott.t1;
    select * from scott.t1;
```

**Oracleæœ€åŸºç¡€çš„éƒ¨åˆ†å·²ç»ç»“æŸäº†,åè¾¹çš„éƒ¨åˆ†å¯ä»¥è‡ªå­¦äº†**å•§