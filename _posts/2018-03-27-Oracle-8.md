---
title: Oracleå®è·µæ•°æ®åº“ç¬”è®°-8
description: äº†è§£Oracleå¯¹æ§åˆ¶æ–‡ä»¶ctlçš„ç®¡ç†å’Œå¯¹æ—¥å¿—æ–‡ä»¶rogçš„ç®¡ç†å’Œæ“ä½œ
categories:
  - è¯¾ç¨‹
tags:
  - Oracle
---
# 3/27 å®ä¾‹æ•°æ®åº“

## ç®¡ç†æ§åˆ¶æ–‡ä»¶

1. æ§åˆ¶æ–‡ä»¶çš„ä½œç”¨â“
2. æ§åˆ¶æ–‡ä»¶çš„å†…å®¹â“äºŒè¿›åˆ¶

oradebug dump controlf 3
oradebug setmypid
oradebug tracefile_name

alter session set nls_language=american

3. æ§åˆ¶æ–‡ä»¶çš„å¤ç”¨ğŸ†—
    å†…å®¹ä¸€æ¨¡ä¸€æ ·ï¼Œåšå¤šä¸ªåŒæ ·çš„æ§åˆ¶æ–‡ä»¶æ”¾åœ¨ä¸åŒçš„åœ°æ–¹

```sql
    è§ppt 126/383
    alter system set control_files = 'path1','path2','path3' scope=spfile;
    shutdown
    cp 'path1'/'path2' 'path3';
    startup
    show parameter control_files;
```

4. åˆ›å»ºæ§åˆ¶æ–‡ä»¶

```sql
alter database backup controlfile to trace as 'e:\trace_controlf.txt'
alter database mount
åˆ é™¤æ§åˆ¶æ–‡ä»¶ä¹‹åå¯åŠ¨æŠ¥é”™å†å¯åŠ¨ä¸€ä¸‹è„šæœ¬
è¯­å¥åœ¨trace_controlf.txté‡Œè¾¹è·‘ä¸€ä¸‹
```

å®éªŒï¼š

1. æŸ¥çœ‹æ§åˆ¶æ–‡ä»¶çš„åç§°å’Œå†…å®¹ğŸ†—
    select name ...
    show parameter control_files;
    oradebug ...è§ä¸Š
2. æ§åˆ¶æ–‡ä»¶çš„å¤ç”¨ğŸ†—
3. åˆ›å»ºæ§åˆ¶æ–‡ä»¶

**ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå†çœ‹å¤§ä½¬æ¼”ç¤ºä¸€ä¸‹è·‘ä¸€ä¸‹è„šæœ¬**


## ç®¡ç†æ—¥å¿—æ–‡ä»¶

1. æ—¥å¿—æ–‡ä»¶çš„ä½œç”¨
2. æ—¥å¿—å·¥ä½œä½“ç³»
3. æ—¥å¿—ç®¡ç†

    **åŠ¡å¿…ææ¸…æ¥šä¸€ä¸‹switchå’Œcheckpointä¸¤æ¡å‘½ä»¤** ğŸ˜‹

    + æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶ç»„ï¼Œæ—¥å¿—æ–‡ä»¶æˆå‘˜ï¼Œå½’æ¡£æ—¥å¿—ğŸ†—
    descä¸€ä¸‹å°±çŸ¥é“äº†v$log v$logfile v$archived_log
    + æ·»åŠ æ—¥å¿—æ–‡ä»¶ç»„ğŸ†—
    ```sql
        alter database add logfile group 4;
     ```
    + å‘æ—¥å¿—æ–‡ä»¶ç»„æ·»åŠ æˆå‘˜ğŸ†—
    ```sql
        alter database add logfile member 'path' to group 4;
     ```
    + åˆ é™¤æ—¥å¿—æ–‡ä»¶æˆå‘˜ğŸ†—
    ```sql
        alter database drop logfile member 'path' to group 4;
        select group#ï¼Œstatus from v$log;
    ```
    + åˆ é™¤æ—¥å¿—æ–‡ä»¶ç»„ğŸ†—
    æ—¥å¿—ç»„åˆ é™¤æ—¶æ—¥å¿—æ–‡ä»¶è¿˜åœ¨ä¸åœ¨ï¼š
    å¦‚æœæ˜¯OMFæ—¥å¿—æ–‡ä»¶åˆ™ä¸åœ¨ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯åœ¨çš„
    ```sql
        alter database drop logfile group 4;
    ```
    + æ¸…é™¤æ—¥å¿—æ–‡ä»¶ğŸ†—
    ```sql
        alter database clear logfile 'path';
    ```
    + OMF æ²¡å¬
    åˆ›å»ºä¸€ä¸ªè·¯å¾„æ”¾å…¥æ—¥å¿—æ–‡ä»¶ï¼ŒOMFå½¢å¼
    + è®¾ç½®å½’æ¡£æ¨¡å¼ 
    ```sql
        ---è¦åœ¨ mountæ¨¡å¼ä¸‹
        startup mount
        alter database archivelog;
        archive log list;
        alter database noarchivelog;
    ```
    + è®¾ç½®å½’æ¡£ç›®çš„åœ°
    + æ‰‹åŠ¨å½’æ¡£
    ```sql
        show parameter log_archive
        alter system set log_archive_dest_1='location=path1'
        alter system archieve log current
    ```
    + ç§»åŠ¨æˆ–è€…é‡å‘½åæ—¥å¿—æ–‡ä»¶
    ```sql
        select group#, from v$logfile
        shutdown immediateä¹‹åå‰ªåˆ‡ï¼ˆä»åŸè·¯å¾„ï¼‰ä¸€ä¸ªlogæ–‡ä»¶åˆ°åˆ«çš„ç›®å½•ï¼ˆç°åœ¨è·¯å¾„ï¼‰
        startup mountä¸æŠ¥é”™ï¼Œä¸æ£€æµ‹æ—¥å¿—æ–‡ä»¶
        alter database openæŠ¥é”™ï¼Œçœ‹æŠ¥é”™ä¿¡æ¯ï¼Œæ‰¾E:\app\Res0liya\diag\rdbms\orcl\orcl\traceç›®å½•ä¸‹çš„alert_orcl.logçœ‹æŠ¥é”™ä¿¡æ¯ï¼Œä»ååˆ°å‰
        select menber from v$logfile
        alter database rename file 'åŸè·¯å¾„' to 'ç°åœ¨è·¯å¾„'
        alter database openå°±ä¸æŠ¥é”™äº†
    ```
    + ä¿®å¤æ—¥å¿—æ–‡ä»¶
        + éå½“å‰çš„æ–‡ä»¶å‡ºé—®é¢˜
        ```sql
            select group#,status from v$log;
            alter database clear logfile group 1;
            alter database open
        ```
        + å½“å‰çš„æ–‡ä»¶å‡ºé—®é¢˜
        ```sql
            recover database until cancel;
            alter database open;æŠ¥é”™
            alter database open resetlogs;é‡æ–°åˆ›å»ºæ–°æ—¥å¿—æ–‡ä»¶
        ```



## å…¶ä»–ä»£ç 

```sql
    ORA-24324: æœªåˆå§‹åŒ–æœåŠ¡å¥æŸ„
    ORA-01041: å†…éƒ¨é”™è¯¯, hostdef æ‰©å±•åä¸å­˜åœ¨
    å‡ºç°shutdowné—®é¢˜é‡‡ç”¨
    shutdown abort
```
